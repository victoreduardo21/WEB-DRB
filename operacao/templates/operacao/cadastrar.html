{% extends 'core/base_operacao.html' %}

{% block title %}Cadastrar Terminal{% endblock %}

{% block content %}
<div class="container mt-3">
    <!-- Botão para abrir o formulário de cadastro -->
    <div class="d-flex justify-content-end mb-3">
        <button class="btn btn-primary" onclick="toggleCadastro()">Cadastrar Novo Terminal</button>
    </div>

    <!-- Tabela de Terminais -->
    <div class="mb-3">
        <h3 class="text-center">Terminais Cadastrados</h3>
        <div class="table-responsive" style="max-height: 400px; overflow-y: auto; border: 1px solid #ddd;">
            <table class="table table-bordered table-sm">
                <thead class="thead-dark">
                    <tr>
                        <th>Nome</th>
                        <th>Cidade</th>
                        <th>Endereço</th>
                        <th>CNPJ</th>
                        <th>Cidade Rota</th>
                        <th>Raio</th>
                        <th>Latitude</th>
                        <th>Longitude</th>
                    </tr>
                </thead>
                <tbody>
                    {% for terminal in terminais %}
                    <tr>
                        <td>{{ terminal.nome }}</td>
                        <td>{{ terminal.cidade }}</td>
                        <td>{{ terminal.endereco }}</td>
                        <td>{{ terminal.cnpj }}</td>
                        <td>{{ terminal.cid_rota }}</td>
                        <td>{{ terminal.raio }}</td>
                        <td>{{ terminal.entrada.0 }}</td>
                        <td>{{ terminal.entrada.1 }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>

    <!-- Formulário de Cadastro de Terminais -->
    <div id="formCadastroCard" class="card w-100" style="display: none;">
        <div class="card-body">
            <h3 class="card-title">Cadastrar Novo Terminal</h3>
            <form method="post">
                {% csrf_token %}
                <div class="row">
                    <div class="form-group col-md-6">
                        <label for="nome">Nome:</label>
                        <input type="text" class="form-control form-control-sm" id="nome" name="nome" required>
                    </div>
                    <div class="form-group col-md-6">
                        <label for="cidade">Cidade:</label>
                        <input type="text" class="form-control form-control-sm" id="cidade" name="cidade" required>
                    </div>
                </div>
                <div class="row">
                    <div class="form-group col-md-6">
                        <label for="endereco">Endereço:</label>
                        <input type="text" class="form-control form-control-sm" id="endereco" name="endereco" required>
                    </div>
                    <div class="form-group col-md-6">
                        <label for="cnpj">CNPJ:</label>
                        <input type="text" class="form-control form-control-sm" id="cnpj" name="cnpj" required>
                    </div>
                </div>
                <div class="row">
                    <div class="form-group col-md-6">
                        <label for="cid_rota">Cidade Rota:</label>
                        <input type="text" class="form-control form-control-sm" id="cid_rota" name="cid_rota">
                    </div>
                    <div class="form-group col-md-6">
                        <label for="raio">Raio:</label>
                        <input type="number" step="0.1" class="form-control form-control-sm" id="raio" name="raio">
                    </div>
                </div>
                <div class="row">
                    <div class="form-group col-md-6">
                        <label for="latitude">Latitude:</label>
                        <input type="text" class="form-control form-control-sm" id="latitude" name="latitude" required>
                    </div>
                    <div class="form-group col-md-6">
                        <label for="longitude">Longitude:</label>
                        <input type="text" class="form-control form-control-sm" id="longitude" name="longitude" required>
                    </div>
                </div>
                <button type="submit" class="btn btn-primary btn-block">Cadastrar</button>
            </form>
            {% if messages %}
            <div class="mt-3">
                {% for message in messages %}
                <div class="alert alert-info">{{ message }}</div>
                {% endfor %}
            </div>
            {% endif %}
        </div>
    </div>
</div>

<script>
    function toggleCadastro() {
        const formCard = document.getElementById('formCadastroCard');
        formCard.style.display = formCard.style.display === 'none' ? 'block' : 'none';
    }
</script>
{% endblock %}
